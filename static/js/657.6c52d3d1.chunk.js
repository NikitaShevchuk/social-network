"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[657],{9270:function(e,s,n){var a=n(5671),t=n(3144),i=n(9340),r=n(2882),o=n(2791),c=n(6871),l=n(8687),u=n(184),d=function(e){return{isAuthorized:e.auth.isAuthorized}};s.Z=function(e){var s=function(s){(0,i.Z)(o,s);var n=(0,r.Z)(o);function o(){return(0,a.Z)(this,o),n.apply(this,arguments)}return(0,t.Z)(o,[{key:"render",value:function(){return this.props.isAuthorized?(0,u.jsx)(e,{}):(0,u.jsx)(c.Fg,{replace:!0,to:"/login"})}}]),o}(o.Component);return(0,l.$j)(d)(s)}},4657:function(e,s,n){n.r(s),n.d(s,{default:function(){return k}});var a=n(2791),t=n(4159),i=n(885),r=n(8683),o=n(5078),c=n(3504),l=n(6871),u=n(8570);var d=n.p+"static/media/send.2ec83b7d2370fbd448eddc161ecfe473.svg",m=n(1598),g=n(4712),h=n(1363),p=n(3174),f=n(2564),x=n(5837),j=n(184),v=function(e){return(0,j.jsx)(o.l0,{onSubmit:e.sendMessage,render:function(e){var s=e.handleSubmit,n=e.submitting,a=e.pristine,t=e.form;return(0,j.jsxs)("form",{onSubmit:s,children:[(0,j.jsx)(o.gN,{onKeyDown:function(e){!function(e,s){"Enter"===e.key&&(e.preventDefault(),s.submit(),s.reset())}(e,t)},name:"body",component:"textarea",placeholder:"Text a message"}),(0,j.jsx)("button",{disabled:n||a,children:(0,j.jsx)("img",{src:d,alt:""})})]})}})},N=function(e){var s=(0,a.useState)(!1),n=(0,i.Z)(s,2),t=n[0],r=n[1];return(0,j.jsxs)("ul",{className:"peoples",children:[(0,j.jsx)("div",{className:"sidebarHeader",children:t?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:"text opacity-animation",children:"Find people"}),(0,j.jsx)(h.G,{className:"opacity-animation",onClick:function(){return r(!1)},icon:p.g82})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:"text opacity-animation",children:"Messages"}),(0,j.jsx)(h.G,{className:"opacity-animation",onClick:function(){return r(!0)},icon:p.g6h})]})}),t?(0,j.jsx)(g.Z,{setSearchMode:r,getDialog:e.getDialog}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"search-users pointer",children:[(0,j.jsx)(h.G,{icon:p.wn1}),(0,j.jsx)(o.l0,{onSubmit:function(s){e.filterDialogs(s.searchBody)},render:function(s){var n=s.handleSubmit,a=(s.submitting,s.pristine,s.form);return(0,j.jsx)("form",{onSubmit:n,children:(0,j.jsx)(o.gN,{name:"searchBody",autoFocus:!0,validate:f.C1,onKeyUp:function(s){(0,x.j)(s,a,e.setDialogs,e.userId),a.submit()},component:"input",placeholder:"Find dialog by name",className:"search-users__input"})})}})]}),e.dialogs[0]?e.dialogs:(0,j.jsx)(u.Z,{})]})]})},b=function(e){var s=(0,l.UO)().userId,n=(0,a.useRef)(null);return(0,a.useEffect)((function(){s&&e.setAllMessages(s),s&&setInterval((function(){return e.setAllMessages(s)}),3e3),e.setDialogs(s)}),[s]),(0,a.useEffect)((function(){n.current&&e.messages[0]&&(n.current.scrollTop=n.current.scrollHeight)}),[e.messages]),(0,j.jsx)("div",{className:"central-meta messages",children:(0,j.jsx)("div",{className:"messages",children:(0,j.jsxs)("div",{className:"message-box",children:[(0,j.jsx)(N,(0,r.Z)((0,r.Z)({},e),{},{userId:s})),(0,j.jsx)("div",{className:"peoples-mesg-box",children:s?(0,j.jsxs)("div",{className:"chatArea opacity-animation",children:[(0,j.jsxs)(c.OL,{replace:!0,to:"/profile/".concat(e.conversationHead.id),className:"conversation-head",children:[(0,j.jsx)("figure",{children:(0,j.jsx)("img",{src:e.conversationHead.photo?e.conversationHead.photo:m,alt:""})}),(0,j.jsx)("span",{children:e.conversationHead.userName})]}),(0,j.jsx)("ul",{className:"chatting-area ps-container ps-theme-default ps-active-y",ref:n,children:e.messages[0]?e.messages:(0,j.jsx)(u.Z,{})}),(0,j.jsx)("div",{className:"message-text-container",children:(0,j.jsx)(v,{sendMessage:function(n){e.sendNewMessage(s,n)}})})]}):(0,j.jsx)("div",{className:"noMessages",children:"Choose friend to start chat"})})]})})})},y=n(8687),Z=n(9270),D=n(7781),M=n(5314),k=(0,D.qC)(Z.Z,(0,y.$j)((function(e){return{messages:(0,M.xq)(e),dialogs:(0,M.c4)(e),conversationHead:e.messagesPage.conversationHead}}),{getDialog:t.Yq,sendNewMessage:t.J,setAllMessages:t.nT,setDialogs:t.ow,filterDialogs:t.J_}))(b)}}]);
//# sourceMappingURL=657.6c52d3d1.chunk.js.map