import{r as u,j as s,c as y,a as o,P as F,F as p,R as w,b as O,f as U,d as R,e as x,g as h,h as j,u as B,p as b,i as E,k as D,l as k,m as A,n as $,M as J,o as H,U as V,q as W,s as S,t as q,v as G,w as v,x as M,y as z,z as Y,A as K,B as Q,C as X,D as Z,E as ee,G as oe}from"./index-839f05df.js";const te="_whiteBg_1seoc_1",ie="_transparent_1seoc_6",re="_jobStyle_1seoc_10",se="_green_1seoc_20",ae="_red_1seoc_26",ne="_icon_1seoc_44",le="_additionalInf_1seoc_49",ce="_additionalInfActive_1seoc_69",de="_editPhoto_1seoc_102",fe="_fileContainer_1seoc_125",ue="_userAvatar_1seoc_139",me="_preloader_1seoc_153",pe="_fileInput_1seoc_164",Pe="_profileData_1seoc_178",he="_hidden_1seoc_182",ge="_shown_1seoc_189",_e="_profileHeader_1seoc_196",c={whiteBg:te,transparent:ie,jobStyle:re,green:se,red:ae,icon:ne,additionalInf:le,additionalInfActive:ce,editPhoto:de,fileContainer:fe,userAvatar:ue,preloader:me,fileInput:pe,profileData:Pe,hidden:he,shown:ge,profileHeader:_e},be=u.memo(({profile:e,isMyProfile:t,profileEditMode:i})=>{const r=e.lookingForAJob?c.green:c.red;return s("div",{className:y(c.profileData,i?c.hidden:c.shown),children:[s("div",{className:"admin-name timeline-info__row",children:[o("h5",{children:e.fullName}),o(F,{isMyProfile:t})]}),o("div",{className:"timeline-info__row",children:s("div",{className:"lookingForAJob",children:[e.aboutMe&&e.aboutMe!==""&&s("div",{className:"small-subtitle",children:[o(p,{icon:"fa-solid fa-address-card"}),o("span",{className:"text",children:"About:"}),e.aboutMe]}),o("div",{className:"lookingForAJobDescription",children:e.lookingForAJobDescription}),s("div",{className:c.jobStyle,children:[o(p,{icon:"fa fa-briefcase",className:c.icon}),"Job status:",o("span",{className:r,children:e.lookingForAJob?" looking for a job":" not interested in job"})]})]})})]})}),Ne=({errorText:e})=>o("div",{className:"local-error",children:o("span",{className:"text",children:e})}),Ie=({onSubmit:e})=>o(w,{onSubmit:e,render:({handleSubmit:t})=>s("form",{onSubmit:t,children:[o(O,{name:"postBody",initialValue:"Posts will be available later...",component:"textarea"}),s("div",{className:"attachments",children:[s("div",{className:"icons",children:[o(p,{icon:U}),o(p,{icon:R})]}),o("button",{type:"button",disabled:!0,className:"add-butn",children:"Post"})]})]})}),Ee=({addPostActionCreator:e})=>o("div",{className:"new-postbox",children:o("div",{className:"newpst-input",children:o(Ie,{onSubmit:i=>{e(i)}})})}),ye=e=>s("div",{className:"loadMore opacity-animation",children:[o(Ee,{state:e.state,onPostChange:e.onPostChange,addPostActionCreator:e.addPostActionCreator,postNewText:e.postNewText,profileImg:e.profileImg}),e.postList]}),Se="/assets/profileCover-7deba932.jpg",ve=e=>o("div",{className:"user-post",children:s("div",{className:"friend-info",children:[o("figure",{children:o("img",{src:e.profileImg,alt:""})}),s("div",{className:"friend-name",children:[o("ins",{children:o("a",{href:e.userName,title:"",children:e.userName})}),o("span",{children:"published: june,2 2018 19:PM"})]}),s("div",{className:"post-meta",children:[o("img",{src:Se,alt:""}),o("div",{className:"description",children:o("p",{children:e.postText})})]})]})}),Me=e=>e.postPage.posts,Fe=e=>{var t;return(t=e.profilePage.profile)==null?void 0:t.photos.small},we=e=>e.profilePage.profile.fullName,ke=x(Me,Fe,we,(e,t,i)=>e.map(r=>o(ve,{postText:r.postText,likesCount:r.likesCount,profileImg:t,userName:i},r.id))),Ae=e=>({postList:ke(e),profileImg:e.auth.profileImg}),Le=h(Ae,{addPostActionCreator:j})(ye),Ce=u.memo(({onPhotoUpload:e})=>o("form",{className:c.editPhoto,children:s("span",{className:c.fileContainer,children:["Edit profile photo",o("input",{onChange:e,className:c.fileInput,type:"file",accept:".jpg, .jpeg, .png"})]})})),l={ableButton:()=>({type:"profile-reducer/ABLE_BUTTON"}),disableButton:()=>({type:"profile-reducer/DISABLE_BUTTON"}),followUserProfile:()=>({type:"profile-reducer/FOLLOW_USER"}),unfollowUserProfile:()=>({type:"profile-reducer/UNFOLLOW_USER"}),isPhotoUpdating:e=>({type:"profile-reducer/PHOTO_UPDATING",isUpdating:e}),setProfileEditMode:e=>({type:"profile-reducer/SET_PROFILE_EDIT_MODE",isInEditMode:e}),setSocialMediaEditMode:e=>({type:"profile-reducer/SET_SOCIAL_MEDIA_EDIT_MODE",isInEditMode:e}),photoUploadedSuccessfully:e=>({type:"profile-reducer/UPD_PHOTO",photos:e}),setUpdatedProfile:e=>({type:"profile-reducer/UPDATE_PROFILE",profile:e}),setIsProfileLoading:e=>({type:"profile-reducer/SET_IS_PROFILE_LOADING",isLoading:e}),setProfile:e=>({type:"profile-reducer/SET_PROFILE",profile:e}),setStatus:e=>({type:"profile-reducer/SET_STATUS",status:e}),setUserId:e=>({type:"profile-reducer/SET_USER_ID",userId:e}),setIsMyProfile:e=>({type:"profile-reducer/SET_IS_MY_PROFILE",isMyProfile:e}),addLocalError:e=>({type:"profile-reducer/ADD_LOCAL_ERROR",localError:e}),addProfileFetchError:e=>({type:"profile-reducer/ADD_PROFILE_FETCH_ERROR",errorText:e}),removeProfileFetchError:()=>({type:"profile-reducer/REMOVE_PROFILE_FETCH_ERROR"})},{setProfileEditMode:L,setUserId:Te,setIsMyProfile:Oe,setSocialMediaEditMode:C}=l,Ue=e=>async t=>{t(l.setIsProfileLoading(!0));try{const i=await B.isFollowing(e);t(i?l.followUserProfile():l.unfollowUserProfile());const r=await b.getProfile(e);t(l.setProfile(r));const a=await b.getStatus(e);t(l.setStatus(a)),t(l.removeProfileFetchError())}catch{t(l.addProfileFetchError("Can't load profile"))}t(l.setIsProfileLoading(!1))},Re=()=>(e,t)=>{e(l.setIsProfileLoading(!0));const i=t().auth.clientProfile;i.userId!==0&&e(l.setProfile(i)),e(l.setIsProfileLoading(!1))},xe=e=>async t=>{t(l.isPhotoUpdating(!0));try{const i=await b.uploadPhoto(e);i.resultCode===E.Success?(t(D.setUserPhoto(i.data.photos.large)),t(l.photoUploadedSuccessfully(i.data.photos))):(t(l.addLocalError(i.messages[0])),setTimeout(()=>{t(l.addLocalError(""))},5e3))}catch{t(k.addError("Network error"))}t(l.isPhotoUpdating(!1))},je=e=>async t=>{try{const i=await b.updateProfile(e);i.resultCode===E.Success?t(l.setUpdatedProfile(e)):i.resultCode===E.Error&&(t(l.addLocalError(i.messages[0])),setTimeout(()=>{t(l.addLocalError(""))},5e3))}catch{t(k.addError("Network error"))}},Be=({isMyProfile:e,disableWhileRequest:t,followed:i,enterEditMode:r,userId:a,profileEditMode:n})=>o("div",{className:"profile-buttons",children:e?!n&&o("button",{type:"button",onClick:r,className:"add-butn transparent",children:"Edit profile"}):s(A,{children:[o($,{followed:i,userId:a,disabled:t}),o(J,{userId:a})]})}),De=({setProfileEditMode:e,isMyProfile:t,userId:i,disableWhileRequest:r,followed:a,profileEditMode:n})=>o(Be,{isMyProfile:t,disableWhileRequest:r,enterEditMode:()=>e(!0),followed:a,userId:i,profileEditMode:n}),$e=e=>({followed:e.profilePage.followed,disableWhileRequest:e.profilePage.disableWhileRequest,isMyProfile:e.profilePage.isMyProfile,userId:e.profilePage.userIdParam,profileEditMode:e.profilePage.profileEditMode}),Je=h($e,{setProfileEditMode:L}),He=Je(De),Ve=({profileLargePhoto:e,photoIsUpdating:t,isMyProfile:i,updatePhoto:r})=>{const a=e&&!t?c.transparent:c.whiteBg,n=d=>{const f=d.target.files?d.target.files[0]:null;f&&r(f)};return s("div",{className:c.profileHeader,children:[o("div",{className:c.userAvatar,children:s("figure",{className:a,children:[t?o(H,{}):o(V,{profileImg:e}),i&&o(Ce,{onPhotoUpload:n})]})}),o(He,{})]})},We=e=>({photoIsUpdating:e.profilePage.photoIsUpdating,isMyProfile:e.profilePage.isMyProfile}),qe=h(We,{updatePhoto:xe}),Ge=qe(Ve),ze=e=>({...e,contacts:{github:e.github,vk:null,facebook:e.facebook,instagram:e.instagram,twitter:e.twitter,website:null,youtube:e.youtube,mainLink:null}}),Ye=(e,t)=>!t||e==="vk"||e==="website"||e==="mainLink",Ke=e=>u.useMemo(()=>e.map(i=>{const r=i[0],a=i[1];return Ye(r,a)?"":o("div",{className:"social-media__element",children:o("a",{href:`${a}`,target:"_blank",rel:"noreferrer",children:o(p,{icon:["fab",`fa-${r}`]})})},e.indexOf(i))}),[e]),Qe=()=>u.useMemo(()=>{const e=q("userId"),t=G("lookingForAJob",null,{active:" looking for a job",inactive:" not interested in job"}),i=W([v],"lookingForAJobDescription"),r=S([M,z,Y],"text","fullName"),a=S([M,v],"text","aboutMe");return{fullNameField:r,userIdField:e,jobDescriptionField:i,jobCheckBox:t,aboutMeField:a}},[]),Xe=e=>{const t=JSON.parse(JSON.stringify(e));return Object.entries(e).forEach(r=>{const[a,n]=r;typeof n!="boolean"&&!n&&n!==""&&(t[a]="")}),t},Ze=e=>e==="website"||e==="vk"||e==="mainLink",eo=({contactsArray:e,socialMediaEditMode:t,setSocialMediaEditMode:i})=>{const r=t?c.additionalInfActive:c.additionalInf,a=u.useRef(null);return K({callback:i,exceptions:["edit-social-media"],ref:a}),o("div",{ref:a,className:y(r,"links-form"),children:e.map(n=>{const d=n[0];return Ze(d)?"":Q([X],n[0],e.indexOf(n),n[1])})})},oo=u.forwardRef(({submitting:e,pristine:t,handleSubmit:i,disableEditMode:r,isMyProfile:a,profileEditMode:n,socialMediaEditMode:d,setSocialMediaEditMode:f,contactsArray:m},P)=>{const{fullNameField:N,userIdField:g,jobDescriptionField:_,jobCheckBox:I,aboutMeField:T}=Qe();return s("form",{className:y(n?"profile-data shown":"profile-data hidden","edit-profile-form"),onSubmit:i,ref:P,children:[s("div",{className:"admin-name timeline-info__row",children:[g,o("h5",{children:N}),o(F,{isMyProfile:a})]}),o("div",{className:"timeline-info__row",children:s("div",{className:"lookingForAJob",children:[s("div",{className:"small-subtitle",children:[o(p,{icon:"fa-solid fa-address-card"}),o("span",{className:"text",children:"About:"}),T]}),o("div",{className:"lookingForAJobDescription-edit",children:_}),s("div",{className:c.jobStyle,children:[o(p,{icon:"fa fa-briefcase",className:c.icon}),o("span",{children:"Job status:"}),I]})]})}),s("div",{className:"edit-profile-buttons",children:[o("button",{type:"submit",disabled:e||t,className:"add-butn",children:"Save"}),o("button",{type:"button",onClick:r,className:"add-butn white",children:"Cancel"})]}),o(eo,{contactsArray:m,socialMediaEditMode:d,setSocialMediaEditMode:f})]})}),to=u.memo(({updateProfile:e,isMyProfile:t,profile:i,setSocialMediaEditMode:r,contactsArray:a,setProfileEditMode:n,profileEditMode:d,socialMediaEditMode:f})=>{const m=u.useRef(null),P=g=>{const _=ze(g);e(_),n(!1)},N=()=>n(!1);return o(w,{initialValues:Xe(i),onSubmit:P,render:({handleSubmit:g,submitting:_,pristine:I})=>o(oo,{ref:m,pristine:I,submitting:_,handleSubmit:g,isMyProfile:t,profileEditMode:d,disableEditMode:N,socialMediaEditMode:f,setSocialMediaEditMode:r,contactsArray:a})})}),io=e=>({socialMediaEditMode:e.profilePage.socialMediaEditMode,contactsArray:e.profilePage.contactsArray}),ro=h(io,{updateProfile:je,setProfileEditMode:L,setSocialMediaEditMode:C}),so=ro(to),ao=({contactsArray:e,profileEditMode:t,contacts:i,socialMediaEditMode:r,setSocialMediaEditMode:a})=>{const n=()=>t&&a(!r),d=Object.values(i).find(m=>m!==null),f=Ke(e);return!d&&!t?o("span",{}):o("div",{className:"additional-profile-info",children:s("div",{className:"social-media",children:[f,!d&&t&&o("span",{className:"text",children:"Add your social media links"}),t&&o("div",{className:`edit-social-media ${r?"close-icon":"edit-icon"}`,onClick:n})]})})},no=e=>({socialMediaEditMode:e.profilePage.socialMediaEditMode,contactsArray:e.profilePage.contactsArray}),lo=h(no,{setSocialMediaEditMode:C}),co=lo(ao),fo=u.memo(({profile:e,loadProfile:t,isMyProfile:i,localError:r,profileIsLoading:a,profileEditMode:n,userId:d,profileFetchError:f})=>{var P;const m=()=>t(d);return a&&!r?o(Z,{}):s("div",{className:"central-meta",children:[r&&o(Ne,{errorText:r}),f&&o(ee,{refetch:m,errorText:f}),!f&&s(A,{children:[s("div",{className:"bg",children:[s("div",{className:"timeline-info",children:[o(Ge,{profileLargePhoto:(P=e.photos)==null?void 0:P.large}),o(so,{profile:e,profileEditMode:n,isMyProfile:i}),o(be,{profileEditMode:n,isMyProfile:i,profile:e})]}),o(co,{contacts:e.contacts,profileEditMode:n})]}),o(Le,{})]})]})}),uo=e=>{const t=oe().userId;return u.useEffect(()=>{const i=t?Number(t):e.myId;e.setUserId(i),i===e.myId||i===0?(e.setIsMyProfile(!0),e.getMyProfileFromState()):(e.setIsMyProfile(!1),e.loadProfile(i))},[t,e.myId]),o(fo,{...e})},mo=e=>({profile:e.profilePage.profile,myId:e.auth.userData.id,localError:e.profilePage.localError,isMyProfile:e.profilePage.isMyProfile,profileEditMode:e.profilePage.profileEditMode,userId:e.profilePage.userIdParam,profileFetchError:e.profilePage.profileFetchError,profileIsLoading:e.profilePage.profileIsLoading}),po=h(mo,{loadProfile:Ue,setIsMyProfile:Oe,setUserId:Te,getMyProfileFromState:Re}),go=po(uo);export{go as default};
